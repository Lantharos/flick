"use strict";
// Runner for Flick interpreter
Object.defineProperty(exports, "__esModule", { value: true });
exports.runFlick = runFlick;
const node_fs_1 = require("node:fs");
const lexer_js_1 = require("./lexer.js");
const parser_js_1 = require("./parser.js");
const interpreter_js_1 = require("./interpreter.js");
const plugin_js_1 = require("./plugin.js");
const builtins_js_1 = require("./plugins/builtins.js");
async function runFlick(filePath) {
    try {
        // Read the source code
        const sourceCode = (0, node_fs_1.readFileSync)(filePath, 'utf-8');
        // Initialize plugin manager
        const pluginManager = new plugin_js_1.PluginManager();
        // Register built-in plugins
        pluginManager.registerPlugin(builtins_js_1.WebPlugin);
        pluginManager.registerPlugin(builtins_js_1.FilesPlugin);
        pluginManager.registerPlugin(builtins_js_1.TimePlugin);
        pluginManager.registerPlugin(builtins_js_1.RandomPlugin);
        // Tokenize
        const lexer = new lexer_js_1.Lexer(sourceCode);
        const tokens = lexer.tokenize();
        // Parse
        const parser = new parser_js_1.Parser(tokens, pluginManager);
        const ast = parser.parse();
        // Interpret
        const interpreter = new interpreter_js_1.Interpreter(pluginManager, filePath);
        await interpreter.interpret(ast);
    }
    catch (error) {
        console.error('Error:', error instanceof Error ? error.message : error);
        process.exit(1);
    }
}
//# sourceMappingURL=runner.js.map